# MetaExtract Security Configuration

# Security Headers Configuration
SECURITY_HEADERS_ENABLED=true
SECURITY_HSTS_ENABLED=true
SECURITY_HSTS_MAX_AGE=31536000
SECURITY_HSTS_INCLUDE_SUBDOMAINS=true
SECURITY_CONTENT_SECURITY_POLICY="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';"
SECURITY_REFERRER_POLICY="strict-origin-when-cross-origin"
SECURITY_FEATURE_POLICY="geolocation 'none'; microphone 'none'; camera 'none'"

# Input Validation Configuration
INPUT_VALIDATION_ENABLED=true
INPUT_MAX_FILENAME_LENGTH=255
INPUT_ALLOWED_FILE_EXTENSIONS=.jpg,.jpeg,.png,.gif,.bmp,.tiff,.tif,.webp,.svg,.pdf,.mp4,.mov,.avi,.mkv,.mp3,.wav,.flac,.aac,.ogg,.m4a,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.rtf
INPUT_SANITIZE_OUTPUT=true

# Rate Limiting Configuration
RATE_LIMITING_ENABLED=true
RATE_LIMIT_DEFAULT_MAX_REQUESTS=100
RATE_LIMIT_DEFAULT_WINDOW_SECONDS=3600
RATE_LIMIT_API_MAX_REQUESTS=1000
RATE_LIMIT_API_WINDOW_SECONDS=3600
RATE_LIMIT_UPLOAD_MAX_REQUESTS=10
RATE_LIMIT_UPLOAD_WINDOW_SECONDS=3600
RATE_LIMIT_LOGIN_MAX_ATTEMPTS=5
RATE_LIMIT_LOGIN_WINDOW_SECONDS=300
RATE_LIMIT_BLOCK_DURATION=3600

# Authentication Security Configuration
AUTHENTICATION_SECURITY_ENABLED=true
FAILED_LOGIN_LOCKOUT_THRESHOLD=5
FAILED_LOGIN_LOCKOUT_DURATION=900
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_COMPLEXITY=true
PASSWORD_COMPLEXITY_REQUIREMENTS=uppercase,lowercase,numbers,special_chars
SESSION_TIMEOUT=3600
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax

# File Upload Security Configuration
FILE_UPLOAD_SECURITY_ENABLED=true
FILE_UPLOAD_MAX_SIZE=209715200  # 200MB
FILE_UPLOAD_ALLOWED_TYPES=image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.*,video/*,audio/*
FILE_UPLOAD_SANDBOX_ENABLED=false
FILE_UPLOAD_VIRUS_SCAN_ENABLED=false
FILE_UPLOAD_TEMP_DIR=/tmp/metaextract_uploads
FILE_UPLOAD_VALIDATE_MIME_TYPE=true

# CSRF Protection Configuration
CSRF_PROTECTION_ENABLED=true
CSRF_TOKEN_TIMEOUT=3600
CSRF_HEADER_NAME=X-CSRF-Token
CSRF_FORM_FIELD_NAME=csrf_token

# Security Logging Configuration
SECURITY_LOGGING_ENABLED=true
SECURITY_LOG_LEVEL=INFO
SECURITY_LOG_FILE=logs/security.log
SECURITY_LOG_RETENTION_DAYS=90
SECURITY_LOG_FAILED_LOGIN_ATTEMPTS=true
SECURITY_LOG_RATE_LIMIT_EXCEEDED=true
SECURITY_LOG_SUSPICIOUS_ACTIVITY=true

# Encryption Configuration
ENCRYPTION_ENABLED=true
ENCRYPTION_ALGORITHM=AES-256-GCM
ENCRYPTION_KEY_ROTATION_DAYS=90
ENCRYPTION_SECURE_KEY_STORAGE=true

# Audit Trail Configuration
AUDIT_TRAIL_ENABLED=true
AUDIT_LOG_LEVEL=INFO
AUDIT_LOG_RETENTION_DAYS=365
AUDIT_INCLUDE_SUCCESSFUL_LOGINS=true
AUDIT_INCLUDE_FAILED_LOGINS=true
AUDIT_INCLUDE_FILE_ACCESSES=true
AUDIT_INCLUDE_ADMIN_ACTIONS=true

# Security Monitoring Configuration
SECURITY_MONITORING_ENABLED=true
SECURITY_MONITORING_INTERVAL=300
SECURITY_ANOMALY_DETECTION_ENABLED=true
SECURITY_ANOMALY_THRESHOLD=0.7
SECURITY_INTRUSION_DETECTION_ENABLED=true
SECURITY_SUSPICIOUS_ACTIVITY_ALERTS=true

# API Security Configuration
API_SECURITY_ENABLED=true
API_KEY_REQUIRED=true
API_KEY_LENGTH=32
API_KEY_EXPIRATION_DAYS=30
API_RATE_LIMIT_ENABLED=true
API_IP_WHITELIST=
API_IP_BLACKLIST=

# Database Security Configuration
DATABASE_ENCRYPTION_ENABLED=true
DATABASE_CONNECTION_ENCRYPTION=true
DATABASE_AUDIT_LOGGING=true
DATABASE_ACCESS_CONTROLS=true

# Network Security Configuration
NETWORK_SECURITY_ENABLED=true
TLS_VERSION=TLSv1.2,TLSv1.3
CIPHER_SUITES=ECDHE-RSA-AES128-GCM-SHA256,ECDHE-RSA-AES256-GCM-SHA384
ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
BLOCK_SUSPICIOUS_IPS=true
IP_REPUTATION_CHECKS=true

# Backup Security Configuration
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_ACCESS_CONTROLS=true
BACKUP_INTEGRITY_CHECKS=true
BACKUP_RETENTION_PERIOD=730  # 2 years

# Third-party Security Configuration
THIRD_PARTY_INTEGRATION_SECURITY=true
THIRD_PARTY_CERTIFICATE_VALIDATION=true
THIRD_PARTY_API_RATE_LIMITING=true
THIRD_PARTY_ACCESS_LOGGING=true

# Security Testing Configuration
SECURITY_TESTING_ENABLED=true
SECURITY_SCANNING_SCHEDULE=0 2 * * 0  # Weekly at 2 AM
SECURITY_VULNERABILITY_ASSESSMENTS=true
SECURITY_PENETRATION_TESTING_SCHEDULE=0 2 1 */3 *  # Quarterly on 1st