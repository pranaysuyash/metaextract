# MetaExtract Alerting Configuration

# Alerting Settings
ALERTING_ENABLED=true
ALERTING_PROVIDER=email  # email, webhook, slack, or multiple
ALERTING_EVALUATION_INTERVAL=300  # seconds between alert evaluations

# Email Alerting
EMAIL_ALERTING_ENABLED=true
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
EMAIL_ALERT_RECIPIENTS=admin@example.com,ops@example.com
EMAIL_FROM=alerts@metaextract.com
EMAIL_SUBJECT_PREFIX="[MetaExtract Alert]"

# Webhook Alerting
WEBHOOK_ALERTING_ENABLED=false
WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
WEBHOOK_TEMPLATE={"text": "{{.AlertName}}: {{.Message}}"}

# Slack Alerting
SLACK_ALERTING_ENABLED=false
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_CHANNEL=#metaextract-alerts
SLACK_USERNAME=MetaExtract-Bot
SLACK_ICON_EMOJI=:warning:

# Alert Rules
# Format: ALERT_NAME=CONDITION;SEVERITY;SUMMARY;DESCRIPTION

# High Error Rate Alert
HIGH_ERROR_RATE_ALERT=error_rate > 0.1;critical;"High error rate detected";"Error rate has exceeded 10% threshold"

# Slow Processing Alert
SLOW_PROCESSING_ALERT=avg_processing_time > 5000;high;"Slow processing detected";"Average processing time has exceeded 5 seconds"

# Low Throughput Alert
LOW_THROUGHPUT_ALERT=extractions_per_minute < 1;medium;"Low throughput detected";"System throughput has dropped below 1 extraction per minute"

# High Resource Usage Alerts
HIGH_CPU_USAGE_ALERT=cpu_usage > 80;high;"High CPU usage detected";"CPU usage has exceeded 80%"
HIGH_MEMORY_USAGE_ALERT=memory_usage > 85;high;"High memory usage detected";"Memory usage has exceeded 85%"
HIGH_DISK_USAGE_ALERT=disk_usage > 90;high;"High disk usage detected";"Disk usage has exceeded 90%"

# Service Down Alert
SERVICE_DOWN_ALERT=health_check_failed;critical;"Service health check failed";"Service health check has failed"

# Notification Settings
NOTIFICATION_REPEAT_INTERVAL=3600  # seconds before repeating same alert
NOTIFICATION_COOLDOWN_PERIOD=600  # seconds before sending next alert of same type
NOTIFICATION_BATCH_ENABLED=true  # batch similar alerts
NOTIFICATION_BATCH_INTERVAL=60  # seconds to batch alerts

# Alert History
ALERT_HISTORY_RETENTION_DAYS=90  # days to keep alert history
ALERT_HISTORY_MAX_ENTRIES=1000  # max number of alerts to keep in history

# Escalation Rules
ESCALATION_ENABLED=true
ESCALATION_CRITERIA=alert_unacknowledged_for > 3600  # escalate after 1 hour
ESCALATION_TARGETS=senior_ops@example.com,manager@example.com
ESCALATION_MESSAGE="Alert has been unacknowledged for more than 1 hour. Immediate attention required."

# Maintenance Window
MAINTENANCE_WINDOW_ENABLED=false
MAINTENANCE_WINDOW_START_TIME=02:00  # UTC time
MAINTENANCE_WINDOW_END_TIME=04:00    # UTC time
MAINTENANCE_WINDOW_DAYS=saturday,sunday  # days to apply maintenance window